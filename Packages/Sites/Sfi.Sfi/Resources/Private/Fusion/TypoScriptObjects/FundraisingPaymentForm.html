{namespace neos=Neos\Neos\ViewHelpers}
<style>
    .color-brown {
        color: #6e584f !important;
    }
    .color-orange {
        color: #ff7800;
    }
    .Button--warn {
        background-color: #ff7800;
    }
    .display-flex {
        display: flex;
    }
</style>
<style>
    .donateForm .input {
        font-size: 1.125rem;
    }
    .PaymentSelector-item {
        padding: 12px 24px;
        box-shadow: 0px 0px 0px 1px #ccc inset;
    }
    .PaymentSelector-item.isActive {
        box-shadow: none;
        background-color: #ff7800;
        color: white !important;
        font-weight: bold;
    }
    .amountPicker {
        border-collapse: collapse;
        width: 100%;
    }
    .amountPicker-cell {
        width: 20%;
        border: 1px solid #ccc;
        padding: 12px 24px;
        color: #828282;
    }
    .amountPicker-cell.isActive {
        font-weight: bold;
        background-color: #ff7800;
        color: white !important;
    }
</style>
<div class="paddingVertical-triple marginVertical-triple">
    <div class="row">
        <div style="border: 10px solid #ff7800; padding: 48px;" class="columns medium-10 medium-offset-1">
            <h2 style="margin-top: 12px; margin-bottom: 48px" class="H2 textAlign-center">{moto -> f:format.raw()}</h2>

            <form data-referer="{projectId}" class="donateForm" id="donate" method="post" name="donate" role="form">
                <div style="margin: 0" class="row PaymentSelector">
                    <div class="textAlign-center column small-6 ParagraphAlt--Large color-grayAlt PaymentSelector-item isActive">Ежемесячное пожертвование</div>
                    <div class="textAlign-center column small-6 ParagraphAlt--Large color-grayAlt PaymentSelector-item">Разовое пожертвование</div>
                </div>

                <div class="ParagraphAlt--Small color-grayAlt marginBottom-half marginTop-double">Сумма</div>

                <table class="amountPicker marginBottom-double">
                    <tr class="amountPicker-row">
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">100&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">200&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">500&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell isActive">1000&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">1500&nbsp;руб.</td>
                    </tr>
                    <tr class="amountPicker-row">
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">2000&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">5000&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell">10&nbsp;000&nbsp;руб.</td>
                        <td class="textAlign-center ParagraphAlt--Large color-grayAlt amountPicker-cell" style="padding: 0" colspan="2">
                            <input class="input" min="0" style="margin-bottom: 0 !important; width: 100%; border: 0; text-align: center; font-size: 1.125rem;"
                                name="amount-other" placeholder="Другая сумма" type="number">
                        </td>
                    </tr>
                </table>

                <div class="row">
                    <div class="columns small-6">
                        <div class="ParagraphAlt--Small color-grayAlt marginBottom-half">
                            <label>Имя</label>
                        </div>
                        <input class="input" name="firstName" placeholder="Имя" type="text" value="">
                    </div>
                    <div class="columns small-6">
                        <div class="ParagraphAlt--Small color-grayAlt marginBottom-half">
                            <label>Фамилия</label>
                        </div>
                        <input class="input" name="lastName" placeholder="Фамилия" type="text" value="">
                    </div>
                </div>

                <div class="ParagraphAlt--Small color-grayAlt marginBottom-half">
                    <label>Ваш e-mail</label>
                </div>
                <input class="input" name="email" placeholder="your@email.ru" type="text" value="">

                <div>
                    <div>
                        <div class="row ParagraphAlt--Small color-grayAlt">
                            <div class="small-6 columns">
                                <input checked class="" name="agreeOffer" type="checkbox" disabled checked="checked"> Я ознакомился c
                                <a href="https://psmb-neos-resources.hb.bizmrg.com/target/sfi/abec2e5c8bbf1618d044a0b08aa541f30886e9f9/donation-offerta.pdf">договором-офертой</a> и согласен с ней
                            </div>
                            <div class="small-6 columns">
                                <input checked class="" name="agreeRf" type="checkbox" disabled checked="checked"> Я являюсь гражданином Российской Федерации
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 48px" class="textAlign-center">
                    <button style="width: 100%; font-weight: bold;" class="Button Button--warn" type="submit">Пожертвовать</button>
                </div>

            </form>
        </div>
    </div>
</div>


<script src="https://widget.cloudpayments.ru/bundles/cloudpayments"></script>
<script type="text/javascript"><![CDATA[
	var amountPickerOtherOption = document.querySelector('.amountPicker-otherOption');
    var amountPickerOtherInput = document.querySelector('.amountPicker-otherInput');
    var amountPickerInputs = document.querySelectorAll('.amountPicker input');
    Array.prototype.forEach.call(amountPickerInputs, function (item) {
        item.addEventListener('change', function (event) {
            amountPickerOtherInput.style.display = event.target.value === 'other' ? 'block' : 'none';
        });
    });

    var form = document.getElementById('donate');
    var pay = function (event) {
        event.preventDefault();

        function getAmount() {
            if (amountPickerOtherOption.checked === true) {
                var otherAmount = Number(form.querySelector('[name=amount-other]').value);
                if (otherAmount > 0) {
                    return otherAmount;
                } else {
                    alert('Кажется вы не указали размер платежа! :-(');
                }

            } else {
                return Number(form.querySelector('[name=amount]:checked').value);
            }
        }

        if (form.querySelector('[name=agreeOffer]').value && form.querySelector('[name=agreeRf]').value) {
            var widget = new cp.CloudPayments();
            var data = {
                firstName: form.querySelector('[name=firstName]').value,
                lastName: form.querySelector('[name=lastName]').value,
                referer: form.dataset.referer
            };
            var isRecurrent = form.querySelector('[name=type]').value === 'monthly';
            if (isRecurrent) {
                data.cloudPayments = {
                    recurrent: {
                        interval: 'Month',
                        period: 1
                    }
                };
            }
            widget.charge({
                publicId: 'pk_6bca8ae9eeae557548776757180c3',
                description: 'Пожертвование на Свято-Филаретовский православно-христианский институт' + (isRecurrent ? ' (регулярное)' : ''),
                amount: getAmount(),
                currency: 'RUB',
                accountId: form.querySelector('[name=email]').value,
                data: data
            },
                'http://sfi.ru/support/thanks.html',
                function (reason, options) {
                    alert('Ошибка' + reason);
                });
        } else {
            alert('Ошибка');
        }
    };
    form.addEventListener('submit', pay);
]]></script>